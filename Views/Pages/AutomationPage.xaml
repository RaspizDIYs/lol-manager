<UserControl x:Class="LolManager.Views.Pages.AutomationPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:converters="clr-namespace:LolManager.Converters"
             x:Name="AutomationPageRoot">
    
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>
        <converters:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibility"/>
        <converters:RunePagePreviewConverter x:Key="RunePagePreviewConverter"/>
        <converters:CollectionCountToVisibilityConverter x:Key="CollectionCountToVisibility"/>
        <!-- ItemTemplate Ð´Ð»Ñ Ñ‡ÐµÐ¼Ð¿Ð¸Ð¾Ð½Ð¾Ð² Ñ Ð¸ÐºÐ¾Ð½ÐºÐ°Ð¼Ð¸ -->
        <DataTemplate x:Key="ChampionTemplate">
            <StackPanel Orientation="Horizontal">
                <Border Width="28" 
                        Height="28" 
                        CornerRadius="14"
                        Margin="0,0,6,0"
                        VerticalAlignment="Center"
                        ClipToBounds="True">
                    <Image Source="{Binding Converter={StaticResource ChampionImageConverter}}" 
                           Stretch="UniformToFill"/>
                </Border>
                <TextBlock Text="{Binding}" 
                           VerticalAlignment="Center"
                           FontSize="12"/>
            </StackPanel>
        </DataTemplate>
        
        <!-- ItemTemplate Ð´Ð»Ñ Ð·Ð°ÐºÐ»Ð¸Ð½Ð°Ð½Ð¸Ð¹ Ñ Ð¸ÐºÐ¾Ð½ÐºÐ°Ð¼Ð¸ -->
        <DataTemplate x:Key="SummonerSpellTemplate">
            <StackPanel Orientation="Horizontal">
                <Image Source="{Binding Converter={StaticResource SummonerSpellImageConverter}}" 
                       Width="22" 
                       Height="22" 
                       Margin="0,0,6,0"
                       VerticalAlignment="Center"/>
                <TextBlock Text="{Binding}" 
                           VerticalAlignment="Center"
                           FontSize="12"/>
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>
    
    <!-- Ð“Ð»Ð°Ð²Ð½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ Ñ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸ÐµÐ¼ Ð¾Ð±Ð»Ð°ÑÑ‚Ð¸ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ -->
    <Border ClipToBounds="True">
        <Grid>
            <!-- Skeleton Loader - Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ Ð¿Ð¾Ð²ÐµÑ€Ñ… Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð° -->
            <StackPanel Margin="16" 
                        HorizontalAlignment="Left" 
                        MaxWidth="550"
                        Panel.ZIndex="10"
                        Visibility="{Binding ElementName=AutomationPageRoot, Path=ViewModel.IsLoading, Converter={StaticResource BoolToVisibility}}">
            <ui:Card Margin="0,0,0,12" Padding="16">
                <StackPanel>
                    <Rectangle Height="28" RadiusX="4" RadiusY="4" Margin="0,0,0,8">
                        <Rectangle.Fill>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <LinearGradientBrush.GradientStops>
                                    <GradientStop Color="#20FFFFFF" Offset="0"/>
                                    <GradientStop Color="#40FFFFFF" Offset="0.5"/>
                                    <GradientStop Color="#20FFFFFF" Offset="1"/>
                                </LinearGradientBrush.GradientStops>
                            </LinearGradientBrush>
                        </Rectangle.Fill>
                    </Rectangle>
                    <Rectangle Height="40" RadiusX="4" RadiusY="4" Margin="0,12,0,0" Fill="#10FFFFFF"/>
                    <Rectangle Height="40" RadiusX="4" RadiusY="4" Margin="0,8,0,0" Fill="#10FFFFFF"/>
                </StackPanel>
            </ui:Card>
            <ui:Card Padding="16">
                <StackPanel>
                    <Rectangle Height="20" Width="120" HorizontalAlignment="Left" RadiusX="4" RadiusY="4" Fill="#10FFFFFF" Margin="0,0,0,8"/>
                    <Rectangle Height="40" RadiusX="4" RadiusY="4" Fill="#10FFFFFF"/>
                    <Rectangle Height="40" RadiusX="4" RadiusY="4" Margin="0,8,0,0" Fill="#10FFFFFF"/>
                </StackPanel>
            </ui:Card>
        </StackPanel>
        
        <!-- Main Content -->
        <ScrollViewer VerticalScrollBarVisibility="Auto"
                      Panel.ZIndex="1"
                      Visibility="{Binding ElementName=AutomationPageRoot, Path=ViewModel.IsLoading, Converter={StaticResource InverseBoolToVisibility}}"
                      DataContext="{Binding ElementName=AutomationPageRoot, Path=ViewModel}">
            <StackPanel Margin="12" HorizontalAlignment="Left" MaxWidth="550">
                
                <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
                <TextBlock Text="ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ" 
                           FontSize="24" 
                           FontWeight="Bold" 
                           Margin="0,0,0,6"/>
                           
                <!-- ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ -->
                <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}" 
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}" 
                        BorderThickness="1" 
                        CornerRadius="8" 
                        Padding="16"
                        Margin="0,0,0,16">
                    <StackPanel Orientation="Horizontal">
                        <Border Background="#FF6B35" 
                                CornerRadius="12" 
                                Width="24" 
                                Height="24" 
                                Margin="0,0,12,0"
                                VerticalAlignment="Top">
                            <TextBlock Text="!" 
                                       Foreground="White" 
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center" 
                                       FontWeight="Bold" 
                                       FontSize="14"/>
                        </Border>
                        <StackPanel>
                            <TextBlock Text="Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ" 
                                       FontWeight="SemiBold" 
                                       FontSize="14"
                                       Margin="0,0,0,4"/>
                            <TextBlock Text="ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ ÐµÑ‰Ñ‘ Ð½Ðµ Ð¸Ð´ÐµÐ°Ð»ÑŒÐ½Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð¸ Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð½Ð° ÑÐ²Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ñ… Ð¸ Ñ€Ð¸ÑÐº."
                                       FontSize="12" 
                                       TextWrapping="Wrap"
                                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                
                <TextBlock Text="ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€ Ñ‡ÐµÐ¼Ð¿Ð¸Ð¾Ð½Ð°, Ð±Ð°Ð½, Ð·Ð°ÐºÐ»Ð¸Ð½Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¸Ð·Ñ‹Ð²Ð°Ñ‚ÐµÐ»Ñ"
                           FontSize="12"
                           Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                           TextWrapping="Wrap"
                           Margin="0,0,0,16"/>

                <!-- Ð’ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸ -->
                <ui:ToggleSwitch IsChecked="{Binding IsAutomationEnabled, Mode=TwoWay}" 
                                Content="Ð’ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ"
                                Margin="0,0,0,16"/>

                <!-- Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð¿ÐµÑ€ÐµÐ´ Ð¿Ð¸ÐºÐ¾Ð¼ -->
                <StackPanel Margin="0,0,0,16">
                    <CheckBox Content="Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð¿ÐµÑ€ÐµÐ´ Ð¿Ð¸ÐºÐ¾Ð¼"
                              IsChecked="{Binding IsPickDelayEnabled, Mode=TwoWay}"
                              IsEnabled="{Binding IsAutomationEnabled}"/>
                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                        <Slider Minimum="0" Maximum="30" TickFrequency="1" IsSnapToTickEnabled="True"
                                Value="{Binding PickDelaySeconds, Mode=TwoWay}"
                                IsEnabled="{Binding IsAutomationEnabled}" Width="200"/>
                        <TextBlock Text="{Binding PickDelaySeconds}" Margin="8,0,0,0" VerticalAlignment="Center"/>
                        <TextBlock Text="ÑÐµÐº" Margin="4,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </StackPanel>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    
                    <!-- ÐŸÐ¾Ð¸ÑÐº Ñ‡ÐµÐ¼Ð¿Ð¸Ð¾Ð½Ð° -->
                    <ui:TextBox Text="{Binding ChampionSearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                IsEnabled="{Binding IsAutomationEnabled}"
                                PlaceholderText="ðŸ” ÐŸÐ¾Ð¸ÑÐº Ñ‡ÐµÐ¼Ð¿Ð¸Ð¾Ð½Ð°..."
                                Margin="0,0,0,6"
                                Grid.ColumnSpan="2"
                                Grid.Row="0"
                                Width="160"
                                HorizontalAlignment="Center"/>
                    
                    <!-- ÐÐ²Ñ‚Ð¾Ð²Ñ‹Ð±Ð¾Ñ€ Ñ‡ÐµÐ¼Ð¿Ð¸Ð¾Ð½Ð° -->
                    <StackPanel                         
                        Grid.Row="1"
                        Grid.Column="0"
                        Margin="0,0,8,0">
                        <TextBlock Text="Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ" 
                                   FontSize="14" 
                                   FontWeight="SemiBold" 
                                   Margin="0,0,0,6"/>
                        <ComboBox ItemsSource="{Binding FilteredChampionsForPick}" 
                                  SelectedItem="{Binding SelectedChampionToPick, Mode=TwoWay}"
                                  IsEnabled="{Binding IsAutomationEnabled}"
                                  MaxDropDownHeight="350"
                                  ItemTemplate="{StaticResource ChampionTemplate}"
                                  Margin="0,0,0,16">
                            <ComboBox.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <VirtualizingStackPanel/>
                                </ItemsPanelTemplate>
                            </ComboBox.ItemsPanel>
                        </ComboBox>
                    </StackPanel>
               
                    <!-- ÐÐ²Ñ‚Ð¾Ð±Ð°Ð½ Ñ‡ÐµÐ¼Ð¿Ð¸Ð¾Ð½Ð° -->
                    <StackPanel                  
                        Grid.Row="1"
                        Grid.Column="1">
                        <TextBlock Text="Ð—Ð°Ð±Ð°Ð½Ð¸Ñ‚ÑŒ" 
                                   FontSize="14" 
                                   FontWeight="SemiBold" 
                                   Margin="0,0,0,6"/>
                        <ComboBox ItemsSource="{Binding FilteredChampionsForBan}" 
                                  SelectedItem="{Binding SelectedChampionToBan, Mode=TwoWay}"
                                  IsEnabled="{Binding IsAutomationEnabled}"
                                  MaxDropDownHeight="350"
                                  ItemTemplate="{StaticResource ChampionTemplate}"
                                  Margin="0,0,0,16">
                            <ComboBox.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <VirtualizingStackPanel/>
                                </ItemsPanelTemplate>
                            </ComboBox.ItemsPanel>
                        </ComboBox>
                    </StackPanel>
                </Grid>

                <!-- Ð—Ð°ÐºÐ»Ð¸Ð½Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¸Ð·Ñ‹Ð²Ð°Ñ‚ÐµÐ»Ñ -->
                
                <Grid Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Ð—Ð°ÐºÐ»Ð¸Ð½Ð°Ð½Ð¸Ðµ 1" 
                                   FontSize="13" 
                                   FontWeight="SemiBold" 
                                   Margin="0,0,0,6"/>
                        <ComboBox ItemsSource="{Binding SummonerSpells}" 
                                  SelectedItem="{Binding SelectedSummonerSpell1, Mode=TwoWay}"
                                  ItemTemplate="{StaticResource SummonerSpellTemplate}"
                                  IsEnabled="{Binding IsAutomationEnabled}">
                        <ComboBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel/>
                            </ItemsPanelTemplate>
                        </ComboBox.ItemsPanel>
                    </ComboBox>
                </StackPanel>
                
                <ui:Button Grid.Column="1"
                          Content="â‡„"
                          FontSize="16"
                          Width="40"
                          VerticalAlignment="Bottom"
                          Margin="6,0,6,0"
                          Command="{Binding SwapSummonerSpellsCommand}"
                          IsEnabled="{Binding IsAutomationEnabled}"
                          ToolTip="ÐŸÐ¾Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð¼ÐµÑÑ‚Ð°Ð¼Ð¸"/>
                
                <StackPanel Grid.Column="2">
                    <TextBlock Text="Ð—Ð°ÐºÐ»Ð¸Ð½Ð°Ð½Ð¸Ðµ 2" 
                               FontWeight="SemiBold" 
                               FontSize="14" 
                               Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding SummonerSpells}" 
                              SelectedItem="{Binding SelectedSummonerSpell2, Mode=TwoWay}"
                              ItemTemplate="{StaticResource SummonerSpellTemplate}"
                              IsEnabled="{Binding IsAutomationEnabled}">
                        <ComboBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel/>
                            </ItemsPanelTemplate>
                            </ComboBox.ItemsPanel>
                        </ComboBox>
                    </StackPanel>
                </Grid>

                <!-- Ð ÑƒÐ½Ñ‹ -->
                <TextBlock Text="Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹ Ñ€ÑƒÐ½" 
                           FontSize="16" 
                           FontWeight="SemiBold" 
                           Margin="0,16,0,8"/>
            
                <ui:ToggleSwitch IsChecked="{Binding AutoRuneGenerationEnabled, Mode=TwoWay}" 
                                 Content="ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð¾Ð²Ð°Ð½Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ñ€ÑƒÐ½"
                                 Margin="0,0,0,8"/>

                <Grid Margin="0,0,0,16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ComboBox Grid.Column="0"
                          ItemsSource="{Binding RunePageNames}"
                          SelectedItem="{Binding SelectedRunePageName, Mode=TwoWay}"
                          IsEnabled="{Binding IsAutomationEnabled}"
                          Margin="0,0,8,0"/>

                <ui:Button Grid.Column="1"
                          Content="ðŸŽ¯ ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ"
                          Command="{Binding ApplySelectedRunePageCommand}"
                          IsEnabled="{Binding IsAutomationEnabled}"
                          Margin="0,0,8,0"
                          ToolTip="ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ñ€ÑƒÐ½ Ð² ÐºÐ»Ð¸ÐµÐ½Ñ‚Ðµ LoL"/>

                <ui:Button Grid.Column="2"
                          Content="+ Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ"
                          Command="{Binding AddRunePageCommand}"
                          IsEnabled="{Binding IsAutomationEnabled}"/>
            </Grid>

            <ItemsControl ItemsSource="{Binding RunePages}"
                          Margin="0,0,0,16"
                          Visibility="{Binding RunePages, Converter={StaticResource CollectionCountToVisibility}}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <ui:Card Margin="0,0,0,6" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- ÐŸÑ€ÐµÐ²ÑŒÑŽ Ñ€ÑƒÐ½ -->
                                <ItemsControl Grid.Column="0"
                                              Margin="0,0,10,0"
                                              VerticalAlignment="Center">
                                    <ItemsControl.ItemsSource>
                                        <MultiBinding Converter="{StaticResource RunePagePreviewConverter}">
                                            <Binding Path="."/>
                                        </MultiBinding>
                                    </ItemsControl.ItemsSource>
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel MaxWidth="180"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Width="24"
                                                    Height="24"
                                                    Margin="2"
                                                    CornerRadius="12"
                                                    Background="#1E2328">
                                                <Image Source="{Binding Converter={StaticResource RuneImageConverter}}"
                                                       Width="20"
                                                       Height="20"
                                                       Stretch="UniformToFill"/>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                
                                <TextBlock Grid.Column="1"
                                          Text="{Binding Name}"
                                          VerticalAlignment="Center"
                                          FontSize="14"
                                          FontWeight="SemiBold"/>
                                
                                <StackPanel Grid.Column="2" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                                    <ui:Button Content="âœï¸"
                                               Width="32"
                                               Height="32"
                                               Margin="4,0"
                                               Command="{Binding ElementName=AutomationPageRoot, Path=ViewModel.EditRunePageCommand}"
                                               CommandParameter="{Binding}"
                                               ToolTip="Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"/>
                                    <ui:Button Content="ðŸ—‘ï¸"
                                               Width="32"
                                               Height="32"
                                               Margin="4,0"
                                               Command="{Binding ElementName=AutomationPageRoot, Path=ViewModel.DeleteRunePageCommand}"
                                               CommandParameter="{Binding}"
                                               ToolTip="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ"/>
                                </StackPanel>
                            </Grid>
                        </ui:Card>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
            
                <TextBlock Text="ðŸ’¾ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸"
                           FontSize="11"
                           Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                           HorizontalAlignment="Left"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
    </Border>
</UserControl>
