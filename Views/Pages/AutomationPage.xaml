<UserControl x:Class="LolManager.Views.Pages.AutomationPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             x:Name="AutomationPageRoot">
    
    <UserControl.Resources>
        <!-- ItemTemplate для чемпионов с иконками -->
        <DataTemplate x:Key="ChampionTemplate">
            <StackPanel Orientation="Horizontal">
                <Border Width="32" 
                        Height="32" 
                        CornerRadius="16"
                        Margin="0,0,8,0"
                        VerticalAlignment="Center"
                        ClipToBounds="True">
                    <Image Source="{Binding Converter={StaticResource ChampionImageConverter}}" 
                           Stretch="UniformToFill"/>
                </Border>
                <TextBlock Text="{Binding}" 
                           VerticalAlignment="Center"/>
            </StackPanel>
        </DataTemplate>
        
        <!-- ItemTemplate для заклинаний с иконками -->
        <DataTemplate x:Key="SummonerSpellTemplate">
            <StackPanel Orientation="Horizontal">
                <Image Source="{Binding Converter={StaticResource SummonerSpellImageConverter}}" 
                       Width="24" 
                       Height="24" 
                       Margin="0,0,8,0"
                       VerticalAlignment="Center"/>
                <TextBlock Text="{Binding}" 
                           VerticalAlignment="Center"/>
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="16" HorizontalAlignment="Left" MaxWidth="600" 
                    DataContext="{Binding ElementName=AutomationPageRoot, Path=ViewModel}">
            
            <!-- Заголовок -->
            <TextBlock Text="Автоматизация" 
                       FontSize="28" 
                       FontWeight="Bold" 
                       Margin="0,0,0,8"/>
            <TextBlock Text="Настройте автоматический выбор чемпиона, бан, заклинания призывателя"
                       FontSize="14"
                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                       TextWrapping="Wrap"
                       Margin="0,0,0,24"/>

            <!-- Включение автоматизации -->
            <ui:ToggleSwitch IsChecked="{Binding IsAutomationEnabled, Mode=TwoWay}" 
                            Content="Включить"
                            Margin="0,0,0,24"/>

           <Grid>
               <Grid.ColumnDefinitions>
                   <ColumnDefinition/>
                   <ColumnDefinition/>
               </Grid.ColumnDefinitions>
               <Grid.RowDefinitions>
                   <RowDefinition/>
                   <RowDefinition/>
               </Grid.RowDefinitions>
               
               <!-- Поиск чемпиона -->
               <ui:TextBox Text="{Binding ChampionSearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           IsEnabled="{Binding IsAutomationEnabled}"
                           PlaceholderText="🔍 Поиск чемпиона..."
                           Margin="0,0,0,8"
                           Grid.ColumnSpan="2"
                           Grid.Row="0"
                           Width="180"
                           HorizontalAlignment="Center"/>
               
               <!-- Автовыбор чемпиона -->
               <StackPanel                         
                   Grid.Row="1"
                   Grid.Column="0"
                   Margin="0,0,10,0">
                   <TextBlock Text="Выбрать" 
                              FontSize="16" 
                              FontWeight="SemiBold" 
                              Margin="0,0,0,8"/>
                  <ComboBox ItemsSource="{Binding FilteredChampionsForPick}" 
                            SelectedItem="{Binding SelectedChampionToPick, Mode=TwoWay}"
                            IsEnabled="{Binding IsAutomationEnabled}"
                            MaxDropDownHeight="400"
                            ItemTemplate="{StaticResource ChampionTemplate}"
                            Margin="0,0,0,24">
                      <ComboBox.ItemsPanel>
                          <ItemsPanelTemplate>
                              <VirtualizingStackPanel/>
                          </ItemsPanelTemplate>
                      </ComboBox.ItemsPanel>
                  </ComboBox>
               </StackPanel>
               
               <!-- Автобан чемпиона -->
               <StackPanel                  
                   Grid.Row="1"
                   Grid.Column="1">
                   <TextBlock Text="Забанить" 
                              FontSize="16" 
                              FontWeight="SemiBold" 
                              Margin="0,0,0,8"/>
                  <ComboBox ItemsSource="{Binding FilteredChampionsForBan}" 
                            SelectedItem="{Binding SelectedChampionToBan, Mode=TwoWay}"
                            IsEnabled="{Binding IsAutomationEnabled}"
                            MaxDropDownHeight="400"
                            ItemTemplate="{StaticResource ChampionTemplate}"
                            Margin="0,0,0,24"
                            Grid.Row="1"
                            Grid.Column="1">
                      <ComboBox.ItemsPanel>
                          <ItemsPanelTemplate>
                              <VirtualizingStackPanel/>
                          </ItemsPanelTemplate>
                      </ComboBox.ItemsPanel>
                  </ComboBox>
               </StackPanel>
           </Grid>

            <!-- Заклинания призывателя -->
            
            <Grid Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Заклинание 1" 
                               FontSize="14" 
                               FontWeight="SemiBold" 
                               Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding SummonerSpells}" 
                              SelectedItem="{Binding SelectedSummonerSpell1, Mode=TwoWay}"
                              ItemTemplate="{StaticResource SummonerSpellTemplate}"
                              IsEnabled="{Binding IsAutomationEnabled}">
                        <ComboBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel/>
                            </ItemsPanelTemplate>
                        </ComboBox.ItemsPanel>
                    </ComboBox>
                </StackPanel>
                
                <ui:Button Grid.Column="1"
                          Content="⇄"
                          FontSize="16"
                          Width="40"
                          VerticalAlignment="Bottom"
                          Margin="6,0,6,0"
                          Command="{Binding SwapSummonerSpellsCommand}"
                          IsEnabled="{Binding IsAutomationEnabled}"
                          ToolTip="Поменять местами"/>
                
                <StackPanel Grid.Column="2">
                    <TextBlock Text="Заклинание 2" 
                               FontWeight="SemiBold" 
                               FontSize="14" 
                               Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding SummonerSpells}" 
                              SelectedItem="{Binding SelectedSummonerSpell2, Mode=TwoWay}"
                              ItemTemplate="{StaticResource SummonerSpellTemplate}"
                              IsEnabled="{Binding IsAutomationEnabled}">
                        <ComboBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel/>
                            </ItemsPanelTemplate>
                        </ComboBox.ItemsPanel>
                    </ComboBox>
                </StackPanel>
            </Grid>
            
            <TextBlock Text="💾 Настройки сохраняются автоматически"
                       FontSize="12"
                       Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                       HorizontalAlignment="Left"/>
        </StackPanel>
    </ScrollViewer>
</UserControl>
